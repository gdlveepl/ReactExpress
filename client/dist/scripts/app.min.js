const App = angular.module('App', ['ngRoute']);

App.config(()=>{

});

App.run(()=>{

});

App.controller("AppContoller",async ($scope,$http)=>{
    $scope.results = [];
    $scope.names = [];

    $scope.loading = true;
    await $http.get("http://PHMANGPAGARIGA2:3030/api/codeCoverage/retrieve")
    .then(response =>{ 
        $scope.names = response.data;
        console.log($scope.names);
        $scope.loading = false;
    });

    $scope.populateTextArea = (data,e) =>{
        $scope.sendToClipBoard(data,e);
        $scope.codeCoverage = JSON.stringify(
            data.codeCoverage.replace(/\\/g, "")
            ,null
            ,2
        );
        $scope.$apply
    }

    $scope.sendToClipBoard = (data,e) => {
        e.target.style = "background-image: linear-gradient(transparent 7px,orange 7px,orange 12px,transparent 12px);"
        var copyElement = document.createElement("textarea");
        copyElement.style.position = 'fixed';
        copyElement.style.opacity = '0';
        copyElement.textContent = data.codeCoverage
        alert(`${data.scriptId} coppied to clipboard`);
        var body = document.getElementsByTagName('body')[0];
        body.appendChild(copyElement);
        copyElement.select();
        document.execCommand('copy');
        body.removeChild(copyElement);
    }
});